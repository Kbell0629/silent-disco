<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Silent Disco Tracker</title><style>body{font-family:Arial,sans-serif;text-align:center;padding:20px}button{padding:15px;font-size:18px;margin:10px;background:#007bff;color:#fff;border:none;border-radius:5px}.form{display:none;flex-direction:column;gap:10px;max-width:400px;margin:20px auto}input,textarea{padding:10px;font-size:16px}#statusList{text-align:left}</style></head><body><h1>Silent Disco Headphone Tracker</h1><button onclick="showCheckout()">Checkout Headphone</button><button onclick="showReturn()">Return Headphone</button><button onclick="showStatus()">View Status</button><div id="checkout" class="form"><h2>Checkout</h2><button id="scanCheckout" onclick="scanNFC('checkout')">Scan NFC Tag</button><input id="headphoneId" placeholder="Headphone ID (e.g., HP123)" readonly><input id="name" placeholder="Full Name"><input id="email" placeholder="Email"><input id="phone" placeholder="Phone Number"><textarea id="agreement" readonly rows="3">If not returned, $100 will be charged.</textarea><input id="signature" placeholder="Sign by typing your name"><input id="card" placeholder="Card Last 4 Digits"><button onclick="checkout()">Complete Checkout</button></div><div id="return" class="form"><h2>Return</h2><button id="scanReturn" onclick="scanNFC('return')">Scan NFC Tag</button><input id="returnId" placeholder="Headphone ID" readonly><button onclick="returnHeadphone()">Return</button></div><div id="status" class="form"><h2>Status</h2><pre id="statusList"></pre></div><script>let headphones=JSON.parse(localStorage.getItem("headphones"))||{};function showCheckout(){toggleForms("checkout")}function showReturn(){toggleForms("return")}function showStatus(){toggleForms("status"),document.getElementById("statusList").textContent=JSON.stringify(headphones,null,2)}function toggleForms(e){["checkout","return","status"].forEach(t=>document.getElementById(t).style.display=t===e?"flex":"none")}async function scanNFC(e){const t=document.getElementById("checkout"===e?"scanCheckout":"scanReturn");t.disabled=!0;let n=null;"NDEFReader"in window?(n=new NDEFReader(),n.scan().then(()=>{n.onreading=e=>{const o=e.serialNumber||`HP${Object.keys(headphones).length+1}`;setId(e,o),alert(`Scanned headphone: ${o}`),t.disabled=!1},n.onreadingerror=()=>{alert("No NFC tag detected. Try again or enter manually."),manualEntry(e),t.disabled=!1}}).catch(o=>{alert(`NFC error: ${o.message}. Enter ID manually.`),manualEntry(e),t.disabled=!1})):(alert("NFC not supported in this browser. Enter ID manually."),manualEntry(e),t.disabled=!1)}function manualEntry(e){const t=prompt("Enter headphone ID (e.g., HP123):");t&&(setId(e,t),document.getElementById("checkout"===e?"scanCheckout":"scanReturn").disabled=!1)}function setId(e,t){"checkout"===e?document.getElementById("headphoneId").value=t:document.getElementById("returnId").value=t}function checkout(){const e=document.getElementById("headphoneId").value,t=document.getElementById("name").value,n=document.getElementById("email").value,o=document.getElementById("phone").value,a=document.getElementById("signature").value,d=document.getElementById("card").value;if(!e||!t||!n||!o||!a||!d)return void alert("Please fill all fields!");if(a.toLowerCase()!==t.toLowerCase())return void alert("Signature must match name!");if(headphones[e]&&"checked_out"===headphones[e].status)return void alert("This headphone is already checked out!");headphones[e]={status:"checked_out",customer:{name:t,email:n,phone:o},agreement:{text:"If not returned, $100 charged.",signed_by:a,amount:100},pre_auth:{card_last4:d,pre_auth_id:`PREAUTH-${e}-${Date.now()}`,amount:100}},localStorage.setItem("headphones",JSON.stringify(headphones)),alert(`Headphone ${e} checked out!`),clearForm("checkout"),showCheckout()}function returnHeadphone(){const e=document.getElementById("returnId").value;if(!e)return void alert("Please scan a headphone!");if(headphones[e]&&"checked_out"===headphones[e].status)headphones[e].status="returned",headphones[e].pre_auth=null,localStorage.setItem("headphones",JSON.stringify(headphones)),alert(`Headphone ${e} returned!`),clearForm("return"),showReturn();else alert("Headphone not found or not checked out!")}function clearForm(e){document.getElementById(e).querySelectorAll("input").forEach(e=>e.value="")}</script></body></html>